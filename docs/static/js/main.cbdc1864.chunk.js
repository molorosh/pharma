(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(e,t,a){},11:function(e,t,a){e.exports=a.p+"static/media/logo.c695c8b2.svg"},15:function(e,t,a){e.exports=a(26)},20:function(e,t,a){},26:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(13),o=a.n(l),s=(a(20),a(1)),i=a(2),c=a(4),m=a(3),u=a(5),d=a(7),h=a(11),p=a.n(h),E=new(a(14).a)("MoloroshPharmaDB");E.version(1).stores({persons:"++id"}),E.version(2).stores({persons:"++id",meds:"++id,personId"});var v=E,f=(a(10),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChangeName=function(e){a.setState({newUserName:e.target.value})},a.doChangeNewUserName=function(e){a.setState({newUserName:e.target.value})},a.doChangeNewUserIcon=function(e){a.setState({newUserIcon:e.target.value})},a.doChangeNewUserColor=function(e){a.setState({newUserColor:e.target.value})},a.doAttemptAddNewUser=function(){var e=a.state.newUserName,t=a.state.newUserColor,n=a.state.newUserIcon,r=void 0,l=0;a.isEmptyOrSpaces(e)&&(r="Please enter intitials (or nickname)",l++),a.setState({errUserName:r},function(){0===l&&a.props.callbackPersonAdd(e,n,t)})},a.state={personId:e.personId,newUserName:"",newUserColor:"Pink",newUserIcon:"\u06dd",errUserName:void 0,colors:["Pink","Orchid","Salmon","Orange","Khaki","Gainsboro"],icons:["\u06dd","\u06de","\u229c","\u229e","\u2299","\u2297"]},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.state.personId&&v.table("persons").get(this.state.personId).then(function(t){e.setState({newUserName:t.name})})}},{key:"isEmptyOrSpaces",value:function(e){return null===e||void 0===e||null!==e.match(/^ *$/)}},{key:"isSomething",value:function(e){return!this.isEmptyOrSpaces(e)}},{key:"render",value:function(){var e=this,t="pharma-person-control",a="",n=void 0,l=void 0;if(void 0===this.props.personId){t+=" pharma-person-add",a="Add New Person";var o=this.state.colors.slice().map(function(e){var t={backgroundColor:e};return r.a.createElement("option",{style:t,key:e,value:e},e)}),s={backgroundColor:this.state.newUserColor},i=r.a.createElement("select",{style:s,onChange:this.doChangeNewUserColor,value:this.state.newUserColor},o),c=this.state.icons.slice().map(function(e){return r.a.createElement("option",{key:e,value:e},e)}),m=r.a.createElement("select",{onChange:this.doChangeNewUserIcon,value:this.state.newUserIcon},c);n=r.a.createElement(r.a.Fragment,null,r.a.createElement("table",{className:"pharma-edit-layout"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"2",className:"pharma-edit-layout-error"},this.state.errUserName)),r.a.createElement("tr",null,r.a.createElement("td",{className:"pharma-edit-layout-label"},"initials:"),r.a.createElement("td",{className:"pharma-edit-layout-control"},r.a.createElement("input",{type:"text",size:"5",maxLength:"5",value:this.state.newUserName,onChange:this.doChangeNewUserName}))),r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"2",className:"pharma-edit-layout-error"})),r.a.createElement("tr",null,r.a.createElement("td",{className:"pharma-edit-layout-label"},"color:"),r.a.createElement("td",{className:"pharma-edit-layout-control"},i)),r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"2",className:"pharma-edit-layout-error"})),r.a.createElement("tr",null,r.a.createElement("td",{className:"pharma-edit-layout-label"},"icons:"),r.a.createElement("td",{className:"pharma-edit-layout-control"},m))))),l=r.a.createElement("button",{onClick:this.doAttemptAddNewUser,className:"pharma-btn pharma-btn-add"},"Add New Person")}else"delete"===this.props.mode?(t+=" pharma-person-delete",a="Delete Person and Medicines",n=r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"person to delete: ",r.a.createElement("strong",null,this.state.newUserName))),l=r.a.createElement("button",{onClick:function(){e.props.callbackPersonDelete(e.state.personId)},className:"pharma-btn pharma-btn-delete"},"Delete [",this.state.newUserName,"]")):(t+=" pharma-person-edit",a="Edit Person");return r.a.createElement("div",{className:t},r.a.createElement("h3",null,r.a.createElement("code",null,a)),n,r.a.createElement("p",null,r.a.createElement("button",{onClick:this.props.onCancel,className:"pharma-btn pharma-btn-cancel"},"Cancel"),l))}}]),t}(n.Component)),g=a(6),b=a.n(g),y=a(9),k=new(function(){function e(){var t=this;Object(s.a)(this,e),this.fromDateToDateString=function(e){var t=e.getFullYear()+"-",a=e.getMonth();a<9&&(t+="0"),t+=a+1+"-";var n=e.getDate();return n<10&&(t+="0"),t+=n},this.today=function(){return t.fromDateToDateString(new Date)},this.givePrn=function(e,a,n){console.log("DAL: givePrn("+e+","+a+","+n+")");var r=n-a,l=t.today();console.log("DAL: newStock = "+r),console.log("DAL: newToday = "+l);var o={stockDate:l,stockAmount:r};return Object(y.a)(b.a.mark(function t(){return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.table("meds").where(":id").equals(e).modify(o);case 2:case"end":return t.stop()}},t)}))(),[]},this.restockMedication=function(e,a){var n=[],r=void 0;if(t.isEmptyOrSpaces(a)?n.push({name:"err_stockAmount",msg:"You must supply a restock level"}):(r=parseInt(a,10))&&r.toString&&r.toString()===a?r<1&&n.push({name:"err_stockAmount",msg:"Restock level must be more than zero"}):n.push({name:"err_stockAmount",msg:"You must supply a valid restock level"}),0===n.length){var l={stockDate:t.today(),stockAmount:r};Object(y.a)(b.a.mark(function t(){return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.table("meds").where(":id").equals(e).modify(l);case 2:case"end":return t.stop()}},t)}))()}return n},this.mustBeSomething=function(e,a){var n={isValid:!1,value:void 0,msg:void 0};return t.isSomething(e)?(n.isValid=!0,n.value=e):n.msg="You must supply a "+a,n},this.mustBePositiveInteger=function(e,a){var n={isValid:!1,value:void 0,msg:void 0},r=void 0;return t.isEmptyOrSpaces(e)?n.msg="You must supply a "+a:(r=parseInt(e,10))&&r.toString&&r.toString()===e?r<1?n.msg=a+" must be more than zero":(n.isValid=!0,n.value=r):n.msg="You must supply a valid "+a,n},this.addMedication=function(e,a,n,r,l,o,s){var i=[],c=t.mustBePositiveInteger(n,"Stock Amount");c.isValid||i.push({name:"err_stockAmount",msg:c.msg});var m=t.mustBeSomething(a,"Medicine Name");m.isValid||i.push({name:"err_name",msg:m.msg});var u=t.mustBePositiveInteger(r,"Dose");u.isValid||i.push({name:"err_scheduleAmount",msg:u.msg});var d=t.mustBeSomething(l,"Strength");if(d.isValid||i.push({name:"err_strength",msg:d.msg}),0===i.length){var h={personId:e,name:m.value,strength:d.value,units:s,stockDate:t.today(),stockAmount:c.value,scheduleAmount:u.value,everyNdays:o};Object(y.a)(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:v.table("meds").add(h);case 1:case"end":return e.stop()}},e)}))()}return i},this.deleteMedication=function(e){return v.table("meds").where("id").equals(e).delete(),[]}}return Object(i.a)(e,[{key:"isEmptyOrSpaces",value:function(e){return null===e||void 0===e||null!==e.match(/^ *$/)}},{key:"isSomething",value:function(e){return!this.isEmptyOrSpaces(e)}}]),e}()),N=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).doChange_stockAmount=function(e){a.setState({stockAmount:e.target.value})},a.doChange_name=function(e){a.setState({name:e.target.value})},a.doChange_units=function(e){a.setState({units:e.target.value})},a.doChange_strength=function(e){a.setState({strength:e.target.value})},a.doChange_stockDate=function(e){a.setState({stockDate:e.target.value})},a.doChange_scheduleAmount=function(e){a.setState({scheduleAmount:e.target.value})},a.doChange_everyNdays=function(e){a.setState({everyNdays:e.target.value})},a.clearErrors=function(){a.setState({err_stockAmount:"",err_everyNdays:"",err_name:"",err_scheduleAmount:"",err_stockDate:"",err_strength:"",err_units:""})},a.showErrors=function(e){if(e&&e.length){for(var t={},n=0,r=e.length;n<r;n++)t[e[n].name]=e[n].msg;a.setState(t)}},a.processRestock=function(){a.clearErrors();var e=k.restockMedication(a.state.medicineId,a.state.stockAmount);0===e.length?a.props.onRestock():a.showErrors(e)},a.processPrn=function(e){console.log("processPrn("+e+")"),a.clearErrors();var t=k.givePrn(a.state.medicineId,e,a.state.stockAmount);0===t.length?a.props.onPrn():a.showErrors(t)},a.processDelete=function(){a.clearErrors();var e=k.deleteMedication(a.state.medicineId);0===e.length?a.props.onDelete():a.showErrors(e)},a.processAdd=function(){a.clearErrors();var e=k.addMedication(a.state.personId,a.state.name,a.state.stockAmount,a.state.scheduleAmount,a.state.strength,a.state.everyNdays,a.state.units);console.log(e),0===e.length?a.props.onAdd():a.showErrors(e)},a.state={unitList:["tablets(s)","ml"],dayList:["0","1","2","3","4","5","6","7"],personId:e.personId,medicineId:e.medicineId,name:"",strength:"",stockDate:"",units:"",stockAmount:"",scheduleAmount:"",everyNdays:"",err_name:"",err_strength:"",err_stockDate:"",err_units:"",err_stockAmount:"",err_scheduleAmount:"",err_everyNdays:""},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"isEmptyOrSpaces",value:function(e){return null===e||void 0===e||null!==e.match(/^ *$/)}},{key:"isSomething",value:function(e){return!this.isEmptyOrSpaces(e)}},{key:"componentDidMount",value:function(){if(this.state.medicineId&&this.state.medicineId>0){var e=this;v.table("meds").get(this.state.medicineId).then(function(t){e.setState({name:t.name,strength:t.strength,units:t.units,stockDate:t.stockDate,stockAmount:"restock"===e.props.mode?"":t.stockAmount,scheduleAmount:t.scheduleAmount,everyNdays:t.everyNdays})})}else this.setState({units:this.state.unitList[0],everyNdays:this.state.dayList[0]})}},{key:"render",value:function(){var e=this,t="pharma-medicine-control",a="",n=r.a.createElement(r.a.Fragment,null),l=r.a.createElement(r.a.Fragment,null),o=r.a.createElement(r.a.Fragment,null),s=r.a.createElement(r.a.Fragment,null);this.isSomething(this.state.med_strength)&&(s=r.a.createElement("em",null,"(",this.state.med_strength,")"));var i=r.a.createElement("p",null,r.a.createElement("strong",null,this.state.name)," ",s);if(void 0===this.props.medicineId){t+=" pharma-medicine-add",a="Add New Medicine",n=r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:this.processAdd,className:"pharma-btn pharma-btn-add"},"Add"));var c=this.state.unitList.slice().map(function(e){return r.a.createElement("option",{key:e,value:e},e)}),m=this.state.dayList.slice().map(function(e){var t="";return t="0"===e?"PRN (take as required)":"1"===e?"Every Day":"Every "+e+" Days",r.a.createElement("option",{key:e,value:e},t)}),u="0"===this.state.everyNdays?"minimum dose":"dose";o=r.a.createElement(r.a.Fragment,null,r.a.createElement("table",{className:"pharma-edit-layout"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"2",className:"pharma-edit-layout-error"},this.state.err_name)),r.a.createElement("tr",null,r.a.createElement("td",{className:"pharma-edit-layout-label"},"name:"),r.a.createElement("td",{className:"pharma-edit-layout-control"},r.a.createElement("input",{type:"text",value:this.state.name,onChange:this.doChange_name}))),r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"2",className:"pharma-edit-layout-error"},this.state.err_units)),r.a.createElement("tr",null,r.a.createElement("td",{className:"pharma-edit-layout-label"},"units:"),r.a.createElement("td",{className:"pharma-edit-layout-control"},r.a.createElement("select",{onChange:this.doChange_units,value:this.state.units},c))),r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"2",className:"pharma-edit-layout-error"},this.state.err_strength)),r.a.createElement("tr",null,r.a.createElement("td",{className:"pharma-edit-layout-label"},"strength:"),r.a.createElement("td",{className:"pharma-edit-layout-control"},r.a.createElement("input",{type:"text",value:this.state.strength,onChange:this.doChange_strength}))),r.a.createElement("tr",null,r.a.createElement("td",{className:"pharma-edit-layout-label"},"schedule:"),r.a.createElement("td",{className:"pharma-edit-layout-control"},r.a.createElement("select",{onChange:this.doChange_everyNdays,value:this.state.everyNdays},m)),r.a.createElement("td",{className:"pharma-edit-layout-error"},this.state.err_everyNdays)),r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"2",className:"pharma-edit-layout-error"},this.state.err_scheduleAmount)),r.a.createElement("tr",null,r.a.createElement("td",{className:"pharma-edit-layout-label"},u,":"),r.a.createElement("td",{className:"pharma-edit-layout-control"},r.a.createElement("input",{type:"text",value:this.state.scheduleAmount,onChange:this.doChange_scheduleAmount}),"\xa0",this.state.units)),r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"2",className:"pharma-edit-layout-error"},this.state.err_stockAmount)),r.a.createElement("tr",null,r.a.createElement("td",{className:"pharma-edit-layout-label"},"stock level:"),r.a.createElement("td",{className:"pharma-edit-layout-control"},r.a.createElement("input",{type:"text",size:"5",maxLength:"5",value:this.state.stockAmount,onChange:this.doChange_stockAmount}))))))}else if("delete"===this.props.mode)t+=" pharma-medicine-delete",a="Delete Medicine",o=r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"You have chosen to delete the following medication:"),i,r.a.createElement("p",null,this.state.scheduleAmount," ",this.state.units," every ",this.state.scheduleAmount," days")),n=r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{key:"d",onClick:this.processDelete,className:"pharma-btn pharma-btn-delete"},"Delete"));else if("prn"===this.props.mode){t+=" pharma-medicine-prn",a="Give PRN",o=r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"You have chosen to give the following medication as PRN:"),i,r.a.createElement("p",{className:"pharma-edit-layout-error"},this.state.err_prn));for(var d=parseFloat(this.state.stockAmount),h=parseFloat(this.state.scheduleAmount),p=[],E=1;E<5;E++)E*h<=d&&p.push({id:E,val:E*h,key:E});var v=this,f=p.map(function(t){return r.a.createElement("li",{key:t.id.toString()},r.a.createElement("button",{onClick:function(){v.processPrn(t.val)},className:"pharma-btn pharma-btn-prn"},"Give ",t.val," ",e.state.units))});l=r.a.createElement("ul",{className:"plain-list"},f)}else"restock"===this.props.mode?(t+=" pharma-medicine-restock",a="Restock Medicine",o=r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"You have chosen to restock the following medication:"),i,r.a.createElement("p",null,this.state.scheduleAmount," ",this.state.units," every ",this.state.scheduleAmount," days"),r.a.createElement("p",null,"Please enter the stock level at the ",r.a.createElement("u",null,"start")," of ",r.a.createElement("u",null,"today")),r.a.createElement("table",{className:"pharma-edit-layout"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{className:"pharma-edit-layout-label"},"Stock amount:"),r.a.createElement("td",{className:"pharma-edit-layout-control"},r.a.createElement("input",{type:"text",size:"5",maxLength:"5",value:this.state.stockAmount,onChange:this.doChange_stockAmount})),r.a.createElement("td",{className:"pharma-edit-layout-error"},this.state.err_stockAmount))))),n=r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{key:"rstck",onClick:this.processRestock,className:"pharma-btn pharma-btn-restock"},"Restock"))):(a="Edit Medicine",t+=" pharma-medicine-edit");return r.a.createElement("div",{className:t},r.a.createElement("h3",null,r.a.createElement("code",null,a)),o,r.a.createElement("p",null,r.a.createElement("button",{onClick:this.props.onCancel,className:"pharma-btn pharma-btn-cancel"},"Cancel"),n),r.a.createElement("ul",null,l))}}]),t}(n.Component),w=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"theHelpDiv"},r.a.createElement("h3",null,r.a.createElement("span",{className:"emoji-prefix",role:"img","aria-label":"Help"},"\u2753"),"Help"),r.a.createElement("h4",null,r.a.createElement("span",{className:"emoji-prefix",role:"img","aria-label":"Purpose"},"\ud83d\udc2c"),"Purpose"),r.a.createElement("p",null,"This is a small web app to track multiple medication prescriptions for one or more people, and to show when medicines are predicted to run out."),r.a.createElement("h4",null,r.a.createElement("span",{className:"emoji-prefix",role:"img","aria-label":"Instructions"},"\ud83d\udcd6"),"Instructions"),r.a.createElement("p",null,"The ",r.a.createElement("b",null,"New Person")," button lets you create a new person.  No need to give the full name, just initials or a nickname will do."),r.a.createElement("p",null,"The ",r.a.createElement("b",null,"Add Medicine")," button lets you add a medication for a person.  Just fill out the details and it will work how many full days of days are left before you must get another prescription.  If the person has several pills throughout the day, just give the daily total."),r.a.createElement("p",null,"The ",r.a.createElement("b",null,"Give PRN")," button lets you give multiples of the minimum PRN dose.  As PRN does not follow a definate schedule, we don't show predictions for the end of PRN stock, but do indicate the number of minimum doses available."),r.a.createElement("p",null,"The ",r.a.createElement("b",null,"Restock Medicine"),' button lets you correct the amount of a medicine.  Please enter the "new" stock leval at the start of the day (i.e. include, as stock, any meds you have already given ',r.a.createElement("u",null,"today"),")."),r.a.createElement("p",null,"The ",r.a.createElement("b",null,"Delete Medicine")," button will allow you to remove a medication from a user."),r.a.createElement("p",null,"The ",r.a.createElement("b",null,"Delete Person")," button will allow you to remove a person and all their medication from the web app."),r.a.createElement("h4",null,r.a.createElement("span",{className:"emoji-prefix",role:"img","aria-label":"Warning"},"\u26a0\ufe0f"),"Oops!"),r.a.createElement("p",null,"Deletions (and Additions and Restocks) always go to a confirmation screen, so don't worry about accididentally hitting a button - just click the ",r.a.createElement("b",null,"Cancel")," button."),r.a.createElement("h4",null,r.a.createElement("span",{className:"emoji-prefix",role:"img","aria-label":"Data"},"\ud83d\udcbe"),"Data"),r.a.createElement("p",null,"Because medication details are highly personal medical data, this app does not store any data remotely. All prescription and stock level data is stored locally on the phone or tablet or computer you are currently looking at."),r.a.createElement("p",null,"This does however mean that if you set up all the information on your phone, it will not appear in your tablet, so please take a moment to choose if it's best for you to keep the information on your personal smartphone, or on a shared tablet or computer."),r.a.createElement("h4",null,r.a.createElement("span",{className:"emoji-prefix",role:"img","aria-label":"Email"},"\ud83d\udce7"),"Feedback"),r.a.createElement("p",null,"The app email address is: ",r.a.createElement("a",{href:"mailto:pharma@molorosh.com"},"pharma@molorosh.com"),". Please feel free to send an email with any feedback, comments, problems, questions or new feature suggestions."),r.a.createElement("h4",null,r.a.createElement("span",{className:"emoji-prefix",role:"img","aria-label":"Crystal Ball"},"\ud83d\udd2e"),"Future Features"),r.a.createElement("p",null,"We are looking to introduce an import / export / backup process to allow you to transfer per-person medication records from one device to another."),r.a.createElement("h4",null,r.a.createElement("span",{className:"emoji-prefix",role:"img","aria-label":"Free of Charge"},"\ud83c\ude1a"),"Free of Charge"),r.a.createElement("p",null,"This web app is free to use and always will be :-)"),r.a.createElement("p",null,r.a.createElement("button",{onClick:this.props.doClose,className:"pharma-btn pharma-btn-cancel"},"Close")))}}]),t}(n.Component),A=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"theAboutDiv"},r.a.createElement("h3",null,r.a.createElement("span",{className:"emoji-prefix",role:"img","aria-label":"About"},"\ud83d\udcdc")," About"),r.a.createElement("p",null,"This web app was written by ",r.a.createElement("a",{rel:"noopener noreferrer",target:"_blank",href:"http://www.molorosh.com"},"molorosh"),"."),r.a.createElement("p",null,"If you're a geeky kinda person the source code for the web app is viewable on ",r.a.createElement("a",{rel:"noopener noreferrer",target:"_blank",href:"https://github.com/molorosh/pharma"},"github")),r.a.createElement("h3",null,r.a.createElement("span",{className:"emoji-prefix",role:"img","aria-label":"About"},"\u23f3")," Release History"),r.a.createElement("h4",null,"V 1.0.0.0 @ 6 May 2019"),r.a.createElement("ul",null,r.a.createElement("li",null,"The initial version of the app was published.")),r.a.createElement("h4",null,"V 1.1.0.0 @ 15 August 2021"),r.a.createElement("ul",null,r.a.createElement("li",null,"Some UX updates were made to the application.")),r.a.createElement("h4",null,"V 1.1.0.1 @ 15 August 2021"),r.a.createElement("ul",null,r.a.createElement("li",null,"Fixed a navigtion error witht the 'about' and 'help' buttons."),r.a.createElement("li",null,"Fixed a rogue '2019' date to '2021'.")),r.a.createElement("p",null,"\xa9 2021 molorosh"),r.a.createElement("p",null,r.a.createElement("button",{onClick:this.props.doClose,className:"pharma-btn pharma-btn-cancel"},"Close")))}}]),t}(n.Component),C=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).stripQueryString=function(){if(document.location&&document.location.href){var e=document.location.href;if(a.isSomething(e)){var t=e.indexOf("?");if(t>0){var n=e.slice(0,t);document.location=n}}}},a.doShowPeople=function(){a.setState({docsMode:"people"})},a.doShowHelp=function(){a.setState({docsMode:"help",control:void 0})},a.doShowAbout=function(){a.setState({docsMode:"about",control:void 0})},a.doEditMedicine=function(e,t){a.setState({mode:"edit",personId:e,medicineId:t,control:"medicine"})},a.doDeleteMedicine=function(e,t){console.log("doDeleteMedicine("+e+","+t+")"),a.setState({mode:"delete",personId:e,medicineId:t,control:"medicine"})},a.doRestockMedicine=function(e,t){console.log("doRestockMedicine("+e+","+t+")"),a.setState({mode:"restock",personId:e,medicineId:t,control:"medicine"})},a.doPrnMedicine=function(e,t){console.log("doPrn("+e+","+t+")"),a.setState({mode:"prn",personId:e,medicineId:t,control:"medicine"})},a.doCancelEdit=function(){a.setState({mode:"list",personId:void 0,medicineId:void 0,control:void 0})},a.doEditUser=function(e){a.setState({mode:"edit",personId:e,medicineId:void 0,control:"person"})},a.doDeleteUser=function(e){a.setState({mode:"delete",personId:e,medicineId:void 0,control:"person"})},a.fetchOnlyUsers=function(){v.table("persons").toArray().then(function(e){a.setState({persons:e})})},a.fetchOnlyMeds=function(){v.table("meds").toArray().then(function(e){if(e&&e.length)for(var t=0,n=e.length;t<n;t++)a.doMedsCalculations(e[t]);a.setState({meds:e})})},a.fetchAllData=function(){v.table("persons").toArray().then(function(e){a.setState({persons:e,mode:"list"},a.fetchOnlyMeds())})},a.doMedsCalculations=function(e){if("0"===e.everyNdays){var t=e.stockAmount/e.scheduleAmount;e.daysLeft=parseInt(t)}else{var n=e.stockAmount/e.scheduleAmount*e.everyNdays,r=new Date(Date.parse(e.stockDate+"T00:00:00Z")),l=new Date,o=new Date(Date.UTC(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate())),s=new Date(r.valueOf());s.setDate(s.getDate()+n);var i=s.getTime()-o.getTime(),c=Math.ceil(i/864e5);e.daysLeft=c,e.until=a.fromDateToDateString(s)}},a.callbackMedicineDelete=function(){a.fetchAllData()},a.callbackMedicineRestock=function(){a.fetchAllData()},a.callbackMedicinePrn=function(){a.fetchAllData()},a.callbackMedicineAdd=function(){a.fetchAllData()},a.callbackPersonDelete=function(e){var t=Object(d.a)(Object(d.a)(a));v.table("meds").where("personId").equals(e).delete().then(function(){v.table("persons").where("id").equals(e).delete().then(function(){t.setState({mode:"list",personId:void 0,medicineId:void 0,control:void 0},function(){t.fetchAllData()})})})},a.callbackPersonAdd=function(e,t,n){var r={name:e,icon:t,color:n};v.table("persons").add(r).then(a.fetchAllData())},a.handleChangeName=function(e){a.setState({newUserName:e.target.value})},a.doChangeNewUserName=function(e){a.setState({newUserName:e.target.value})},a.doChangeNewUserIcon=function(e){a.setState({newUserIcon:e.target.value})},a.doChangeNewUserColor=function(e){a.setState({newUserColor:e.target.value})},a.fromDateToDateString=function(e){var t=e.getFullYear()+"-",a=e.getMonth();a<9&&(t+="0"),t+=a+1+"-";var n=e.getDate();return n<10&&(t+="0"),t+=n},a.today=function(){return a.fromDateToDateString(new Date)},a.state={docsMode:"people",mode:"list",control:void 0,personId:void 0,medicineId:void 0,version:"1.1.0.1",meds:[]},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.stripQueryString(),this.fetchAllData()}},{key:"isEmptyOrSpaces",value:function(e){return null===e||void 0===e||null!==e.match(/^ *$/)}},{key:"isSomething",value:function(e){return!this.isEmptyOrSpaces(e)}},{key:"render",value:function(){var e=this;if("list"!==this.state.mode&&this.state.control||"help"===this.state.docsMode||"about"===this.state.docsMode){var t=void 0;return"person"===this.state.control?t=r.a.createElement(f,{onCancel:this.doCancelEdit,mode:this.state.mode,personId:this.state.personId,callbackPersonAdd:this.callbackPersonAdd,callbackPersonDelete:this.callbackPersonDelete}):"medicine"===this.state.control?t=r.a.createElement(N,{onCancel:this.doCancelEdit,onDelete:this.callbackMedicineDelete,onRestock:this.callbackMedicineDelete,onAdd:this.callbackMedicineAdd,onPrn:this.callbackMedicinePrn,mode:this.state.mode,personId:this.state.personId,medicineId:this.state.medicineId}):"help"===this.state.docsMode?t=r.a.createElement(w,{doClose:this.doShowPeople}):"about"===this.state.docsMode&&(t=r.a.createElement(A,{doClose:this.doShowPeople})),r.a.createElement("div",{className:"App"},r.a.createElement("div",{id:"mainContent"},r.a.createElement("header",{className:"App-header"},r.a.createElement("div",{className:"App-header-div"},r.a.createElement("div",{className:"App-header-div-logo"},r.a.createElement("img",{src:p.a,className:"App-logo",alt:"logo"})),r.a.createElement("div",{className:"App-header-div-title"},r.a.createElement("h1",null,"Pharma")))),r.a.createElement("section",{className:"AppSection"},t)),r.a.createElement("div",{id:"footerContent"},r.a.createElement("footer",{className:"App-footer"},r.a.createElement("div",{className:"App-footer-div"},r.a.createElement("div",{className:"App-footer-version"},r.a.createElement("p",{className:"App-footer-version"},"Version: ",r.a.createElement("span",{className:"App-footer-version"},this.state.version))),r.a.createElement("div",{className:"App-footer-copyright"},r.a.createElement("p",{className:"App-footer-copyright"},"\xa9 2021 molorosh"))))))}var a=null,n=null;this.state.persons&&(a=this.state.persons.slice().map(function(t){var a={backgroundColor:t.color},l=e.state.meds.slice();return n=l.map(function(a){var n=r.a.createElement(r.a.Fragment,null),l=r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"days left: ",r.a.createElement("strong",null,a.daysLeft)," ",r.a.createElement("em",null,"(",a.until,")"))),o=r.a.createElement(r.a.Fragment,null,"every ",a.everyNdays," day(s)");if("0"===a.everyNdays&&(o="PRN (take as required)",l=r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"doses left: ",r.a.createElement("strong",null,a.daysLeft))),n=r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(){e.doPrnMedicine(t.id,a.id)},className:"pharma-btn pharma-btn-prn"},"Give PRN"),r.a.createElement("br",null))),a.personId===t.id){var s=r.a.createElement(r.a.Fragment,null);return e.isSomething(a.strength)&&(s=r.a.createElement("em",null,"(",a.strength,")")),r.a.createElement("div",{className:"pharma-person-medicine",key:a.id},r.a.createElement("p",{className:"pharma-person-medicine-edit"},n,r.a.createElement("button",{onClick:function(){e.doRestockMedicine(t.id,a.id)},className:"pharma-btn pharma-btn-restock"},"Restock Medicine"),r.a.createElement("br",null),r.a.createElement("button",{onClick:function(){e.doDeleteMedicine(t.id,a.id)},className:"pharma-btn pharma-btn-delete"},"Delete Medicine")),r.a.createElement("p",null,r.a.createElement("strong",null,a.name)," ",s),r.a.createElement("p",null,a.scheduleAmount," ",a.units," ",o),l)}}),r.a.createElement("div",{key:t.id,className:"pharma-person",style:a},r.a.createElement("p",{className:"pharma-delete-person-para"},r.a.createElement("button",{onClick:function(){e.doDeleteUser(t.id)},className:"pharma-btn pharma-btn-delete"},"Delete Person")),r.a.createElement("h1",null,t.icon," ",t.name),r.a.createElement("h4",null,r.a.createElement("span",{className:"emoji-prefix",role:"img","aria-label":"Medicine"},"\ud83d\udc8a")," Medicines"),r.a.createElement("p",null,r.a.createElement("button",{onClick:function(){e.doEditMedicine(t.id,void 0)},className:"pharma-btn pharma-btn-add"},"Add Medicine")),n)}));return r.a.createElement("div",{className:"App"},r.a.createElement("div",{id:"mainContent"},r.a.createElement("header",{className:"App-header"},r.a.createElement("div",{className:"App-header-div"},r.a.createElement("div",{className:"App-header-div-logo"},r.a.createElement("img",{src:p.a,className:"App-logo",alt:"logo"})),r.a.createElement("div",{className:"App-header-div-title"},r.a.createElement("h1",null,"Pharma")))),r.a.createElement("section",{className:"AppSection"},r.a.createElement("h3",null,r.a.createElement("span",{className:"emoji-prefix",role:"img","aria-label":"People"},"\ud83d\udc65"),"People"),r.a.createElement("div",{className:"theHelp"},r.a.createElement("button",{className:"pharma-btn pharma-btn-help",onClick:this.doShowHelp},"Help")),r.a.createElement("div",{className:"theAbout"},r.a.createElement("button",{className:"pharma-btn pharma-btn-about",onClick:this.doShowAbout},"About")),r.a.createElement("p",null,r.a.createElement("button",{className:"pharma-btn pharma-btn-add",onClick:function(){e.doEditUser(void 0)}},"New Person")),r.a.createElement("div",null,a))),r.a.createElement("div",{id:"footerContent"},r.a.createElement("footer",{className:"App-footer"},r.a.createElement("div",{className:"App-footer-div"},r.a.createElement("div",{className:"App-footer-version"},r.a.createElement("p",{className:"App-footer-version"},"Version: ",r.a.createElement("span",{className:"App-footer-version"},this.state.version))),r.a.createElement("div",{className:"App-footer-copyright"},r.a.createElement("p",{className:"App-footer-copyright"},"\xa9 2021 molorosh"))))))}}]),t}(n.Component),S=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function D(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}o.a.render(r.a.createElement(C,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/pharma",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/pharma","/service-worker.js");S?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):D(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):D(t,e)})}}()}},[[15,1,2]]]);
//# sourceMappingURL=main.cbdc1864.chunk.js.map